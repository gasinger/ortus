drop view if exists allepisode;
create view allepisode as select s.seriesid,e.episodeid, em.mediaid, s.title as showtitle, e.title as episodetitle, s.firstair, s.airday, s.airtime, s.status, s.network, s.userrating, s.mpaarated, s.runtime, e.seasonno, e.episodeno, e.originalairdate from (select t.seriesid, t.seasonno, max(e.episodeno) as episodeno from (select distinct(e.seriesid), max(e.seasonno) as seasonno from sage.episode as e, sage.episodemedia as em where e.episodeid = em.episodeid group by seriesid order by 1,2) as t, sage.episode as e,sage.episodemedia as em where t.seriesid = e.seriesid and t.seasonno = e.seasonno and e.episodeid = em.episodeid group by t.seriesid, t.seasonno order by 1,2,3) as t, sage.episode as e, sage.series as s,sage.episodemedia as em where t.episodeno = e.episodeno and t.seriesid = e.seriesid and t.seasonno = e.seasonno and s.seriesid = e.seriesid and e.episodeid = em.episodeid;